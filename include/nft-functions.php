<?php


function getNFTFirstEdition() : array
{
    return [
        'the-dark-destroyer' => [
            'nft_id' => 1,
            'img_id' => 2,
            'price' => 1,
            'token_id' => '54545543118371850173410875503158003596823792560618288887991952589160886304769',
            'owner' => 0,
            'owner_opensea' => '',
        ],
        'commander-liana-henders' => [
            'nft_id' => 2,
            'img_id' => 0,
            'price' => 0.5,
            'token_id' => '54545543118371850173410875503158003596823792560618288887991952590260397932545',
            'owner' => 0,
            'owner_opensea' => '',
        ],
        'commander-frank-johnson' => [
            'nft_id' => 3,
            'img_id' => 1,
            'price' => 0.5,
            'token_id' => '54545543118371850173410875503158003596823792560618288887991952591359909560321',
            'owner' => 0,
            'owner_opensea' => '',
        ],
        'commander-keve-bakins' => [
            'nft_id' => 4,
            'img_id' => 2,
            'price' => 0.5,
            'token_id' => '54545543118371850173410875503158003596823792560618288887991952592459421188097',
            'owner' => 0,
            'owner_opensea' => '',
        ],
        'commander-nicia-satu' => [
            'nft_id' => 5,
            'img_id' => 3,
            'price' => 0.5,
            'token_id' => '54545543118371850173410875503158003596823792560618288887991952593558932815873',
            'owner' => 0,
            'owner_opensea' => '',
        ],
        'commander-general-jackson' => [
            'nft_id' => 6,
            'img_id' => 4,
            'price' => 0.5,
            'token_id' => '54545543118371850173410875503158003596823792560618288887991952594658444443649',
            'owner' => 0,
            'owner_opensea' => '',
        ],
        'commander-the-miller' => [
            'nft_id' => 7,
            'img_id' => 6,
            'price' => 0.5,
            'token_id' => '54545543118371850173410875503158003596823792560618288887991952595757956071425',
            'owner' => 0,
            'owner_opensea' => '',
        ],
        'the-exterminator' => [
            'nft_id' => 8,
            'img_id' => 1,
            'price' => 0.4,
            'token_id' => '54545543118371850173410875503158003596823792560618288887991952596857467699201',
            'owner' => 0,
            'owner_opensea' => '',
        ],
        'stormfalcon' => [
            'nft_id' => 9,
            'img_id' => 3,
            'price' => 0.3,
            'token_id' => '54545543118371850173410875503158003596823792560618288887991952597956979326977',
            'owner' => 0,
            'owner_opensea' => '',
        ],
        'titan' => [
            'nft_id' => 10,
            'img_id' => 4,
            'price' => 0.3,
            'token_id' => '54545543118371850173410875503158003596823792560618288887991952599056490954753',
            'owner' => 0,
            'owner_opensea' => '',
        ],
        'explosive-missile' => [
            'nft_id' => 11,
            'img_id' => 5,
            'price' => 0.3,
            'token_id' => '54545543118371850173410875503158003596823792560618288887991952600156002582529',
            'owner' => 0,
            'owner_opensea' => '',
        ],
        'fast-missile' => [
            'nft_id' => 12,
            'img_id' => 6,
            'price' => 0.5,
            'token_id' => '54545543118371850173410875503158003596823792560618288887991952601255514210305',
            'owner' => 0,
            'owner_opensea' => '',
        ],
        'emp-missile' => [
            'nft_id' => 13,
            'img_id' => 7,
            'price' => 0.15,
            'token_id' => '54545543118371850173410875503158003596823792560618288887991952602355025838081',
            'owner' => 10,
            'owner_opensea' => 'Galactico',
        ],
        'nuclear-missile' => [
            'nft_id' => 14,
            'img_id' => 8,
            'price' => 0.3,
            'token_id' => '54545543118371850173410875503158003596823792560618288887991952603454537465857',
            'owner' => 0,
            'owner_opensea' => '',
        ],
        'full-attack' => [
            'nft_id' => 15,
            'img_id' => 9,
            'price' => 0.4,
            'token_id' => '54545543118371850173410875503158003596823792560618288887991952604554049093633',
            'owner' => 0,
            'owner_opensea' => '',
        ],
        'good-karma' => [
            'nft_id' => 16,
            'img_id' => 11,
            'price' => 0.15,
            'token_id' => '54545543118371850173410875503158003596823792560618288887991952605653560721409',
            'owner' => 170,
            'owner_opensea' => 'bluemink22',
        ],
        'neutralization' => [
            'nft_id' => 17,
            'img_id' => 12,
            'price' => 0.3,
            'token_id' => '54545543118371850173410875503158003596823792560618288887991952606753072349185',
            'owner' => 0,
            'owner_opensea' => '',
        ],
        'over-capacity' => [
            'nft_id' => 18,
            'img_id' => 13,
            'price' => 0.3,
            'token_id' => '54545543118371850173410875503158003596823792560618288887991952607852583976961',
            'owner' => 0,
            'owner_opensea' => '',
        ],
        'excellent-work' => [
            'nft_id' => 19,
            'img_id' => 14,
            'price' => 0.3,
            'token_id' => '54545543118371850173410875503158003596823792560618288887991952608952095604737',
            'owner' => 0,
            'owner_opensea' => '',
        ],
        'supernova' => [
            'nft_id' => 20,
            'img_id' => 15,
            'price' => 0.5,
            'token_id' => '54545543118371850173410875503158003596823792560618288887991952610051607232513',
            'owner' => 0,
            'owner_opensea' => '',
        ],
        'target-missed' => [
            'nft_id' => 21,
            'img_id' => 16,
            'price' => 0.13,
            'token_id' => '54545543118371850173410875503158003596823792560618288887991952611151118860289',
            'owner' => 5,
            'owner_opensea' => 'Uzbeki',
        ],
        'missiles-launched' => [
            'nft_id' => 22,
            'img_id' => 17,
            'price' => 0.3,
            'token_id' => '54545543118371850173410875503158003596823792560618288887991952612250630488065',
            'owner' => 0,
            'owner_opensea' => '',
        ],
        'perfect-plan' => [
            'nft_id' => 23,
            'img_id' => 18,
            'price' => 0.3,
            'token_id' => '54545543118371850173410875503158003596823792560618288887991952613350142115841',
            'owner' => 0,
            'owner_opensea' => '',
        ],
        'pursuiter' => [
            'nft_id' => 24,
            'img_id' => 19,
            'price' => 0.13,
            'token_id' => '54545543118371850173410875503158003596823792560618288887991952614449653743617',
            'owner' => 10,
            'owner_opensea' => 'Galactico',
        ],
        'grand-opportunity' => [
            'nft_id' => 25,
            'img_id' => 20,
            'price' => 0.15,
            'token_id' => '54545543118371850173410875503158003596823792560618288887991952615549165371393',
            'owner' => 0,
            'owner_opensea' => '',
        ],
        'energy-shield' => [
            'nft_id' => 26,
            'img_id' => 21,
            'price' => 0.3,
            'token_id' => '54545543118371850173410875503158003596823792560618288887991952616648676999169',
            'owner' => 0,
            'owner_opensea' => '',
        ],
        'defense-cannon' => [
            'nft_id' => 27,
            'img_id' => 22,
            'price' => 0.15,
            'token_id' => '54545543118371850173410875503158003596823792560618288887991952617748188626945',
            'owner' => 0,
            'owner_opensea' => '',
        ],
        'trigger-happy-joe' => [
            'nft_id' => 28,
            'img_id' => 24,
            'price' => 0.3,
            'token_id' => '54545543118371850173410875503158003596823792560618288887991952618847700254721',
            'owner' => 0,
            'owner_opensea' => '',
        ],
        'thunderbolt' => [
            'nft_id' => 29,
            'img_id' => 25,
            'price' => 0.15,
            'token_id' => '54545543118371850173410875503158003596823792560618288887991952619947211882497',
            'owner' => 0,
            'owner_opensea' => '',
        ],
        'the-gladiator' => [
            'nft_id' => 30,
            'img_id' => 26,
            'price' => 0.2,
            'token_id' => '54545543118371850173410875503158003596823792560618288887991952621046723510273',
            'owner' => 0,
            'owner_opensea' => '',
        ],
        'the-shade' => [
            'nft_id' => 31,
            'img_id' => 27,
            'price' => 0.3,
            'token_id' => '54545543118371850173410875503158003596823792560618288887991952622146235138049',
            'owner' => 0,
            'owner_opensea' => '',
        ],
        'hunter' => [
            'nft_id' => 32,
            'img_id' => 28,
            'price' => 0.2,
            'token_id' => '54545543118371850173410875503158003596823792560618288887991952623245746765825',
            'owner' => 0,
            'owner_opensea' => '',
        ],
        'small-repair-ship' => [
            'nft_id' => 33,
            'img_id' => 29,
            'price' => 0.15,
            'token_id' => '54545543118371850173410875503158003596823792560618288887991952624345258393601',
            'owner' => 0,
            'owner_opensea' => '',
        ],
        'big-repair-ship' => [
            'nft_id' => 34,
            'img_id' => 30,
            'price' => 0.15,
            'token_id' => '54545543118371850173410875503158003596823792560618288887991952625444770021377',
            'owner' => 0,
            'owner_opensea' => '',
        ],
        'luck' => [
            'nft_id' => 35,
            'img_id' => 31,
            'price' => 0.3,
            'token_id' => '54545543118371850173410875503158003596823792560618288887991952626544281649153',
            'owner' => 0,
            'owner_opensea' => '',
        ],
        'battlestar' => [
            'nft_id' => 36,
            'img_id' => 32,
            'price' => 0.15,
            'token_id' => '54545543118371850173410875503158003596823792560618288887991952627643793276929',
            'owner' => 0,
            'owner_opensea' => '',
        ],
        'avoid' => [
            'nft_id' => 37,
            'img_id' => 34,
            'price' => 0.3,
            'token_id' => '54545543118371850173410875503158003596823792560618288887991952628743304904705',
            'owner' => 0,
            'owner_opensea' => '',
        ],
        'disturbing-sensor' => [
            'nft_id' => 38,
            'img_id' => 37,
            'price' => 0.3,
            'token_id' => '54545543118371850173410875503158003596823792560618288887991952629842816532481',
            'owner' => 0,
            'owner_opensea' => '',
        ],
        'fatal-error' => [
            'nft_id' => 39,
            'img_id' => 38,
            'price' => 0.5,
            'token_id' => '54545543118371850173410875503158003596823792560618288887991952630942328160257',
            'owner' => 0,
            'owner_opensea' => '',
        ],
        'deadly-sniper' => [
            'nft_id' => 40,
            'img_id' => 39,
            'price' => 0.3,
            'token_id' => '54545543118371850173410875503158003596823792560618288887991952632041839788033',
            'owner' => 0,
            'owner_opensea' => '',
        ],
        'discovery' => [
            'nft_id' => 41,
            'img_id' => 42,
            'price' => 0.15,
            'token_id' => '54545543118371850173410875503158003596823792560618288887991952633141351415809',
            'owner' => 0,
            'owner_opensea' => '',
        ],
        'the-liberator' => [
            'nft_id' => 42,
            'img_id' => 56,
            'price' => 0.3,
            'token_id' => '54545543118371850173410875503158003596823792560618288887991952634240863043585',
            'owner' => 0,
            'owner_opensea' => '',
        ],
        'destiny-decided' => [
            'nft_id' => 43,
            'img_id' => 64,
            'price' => 0.5,
            'token_id' => '54545543118371850173410875503158003596823792560618288887991952635340374671361',
            'owner' => 0,
            'owner_opensea' => '',
        ],
        'sabotage' => [
            'nft_id' => 44,
            'img_id' => 67,
            'price' => 0.15,
            'token_id' => '54545543118371850173410875503158003596823792560618288887991952636439886299137',
            'owner' => 0,
            'owner_opensea' => '',
        ],
        'commander-zuuls' => [
            'nft_id' => 45,
            'img_id' => 7,
            'price' => 0.5,
            'token_id' => '54545543118371850173410875503158003596823792560618288887991952637539397926913',
            'owner' => 0,
            'owner_opensea' => '',
        ],
        'commander-crakux' => [
            'nft_id' => 46,
            'img_id' => 8,
            'price' => 0.5,
            'token_id' => '54545543118371850173410875503158003596823792560618288887991952638638909554689',
            'owner' => 0,
            'owner_opensea' => '',
        ],
        'commander-naalox' => [
            'nft_id' => 47,
            'img_id' => 9,
            'price' => 0.5,
            'token_id' => '54545543118371850173410875503158003596823792560618288887991952639738421182465',
            'owner' => 0,
            'owner_opensea' => '',
        ],
        'commander-staux' => [
            'nft_id' => 48,
            'img_id' => 10,
            'price' => 0.5,
            'token_id' => '54545543118371850173410875503158003596823792560618288887991952640837932810241',
            'owner' => 0,
            'owner_opensea' => '',
        ],
        'carrier' => [
            'nft_id' => 49,
            'img_id' => 77,
            'price' => 0.5,
            'token_id' => '54545543118371850173410875503158003596823792560618288887991952641937444438017',
            'owner' => 0,
            'owner_opensea' => '',
        ],
        'drone' => [
            'nft_id' => 50,
            'img_id' => 78,
            'price' => 0.3,
            'token_id' => '54545543118371850173410875503158003596823792560618288887991952643036956065793',
            'owner' => 0,
            'owner_opensea' => '',
        ],
        'toxic-gas' => [
            'nft_id' => 51,
            'img_id' => 79,
            'price' => 0.3,
            'token_id' => '54545543118371850173410875503158003596823792560618288887991952644136467693569',
            'owner' => 0,
            'owner_opensea' => '',
        ],
        'fusion-ship' => [
            'nft_id' => 52,
            'img_id' => 80,
            'price' => 0.3,
            'token_id' => '54545543118371850173410875503158003596823792560618288887991952645235979321345',
            'owner' => 0,
            'owner_opensea' => '',
        ],
        'shield' => [
            'nft_id' => 53,
            'img_id' => 81,
            'price' => 0.15,
            'token_id' => '54545543118371850173410875503158003596823792560618288887991952646335490949121',
            'owner' => 0,
            'owner_opensea' => '',
        ],
        'alien-missile' => [
            'nft_id' => 54,
            'img_id' => 83,
            'price' => 0.15,
            'token_id' => '54545543118371850173410875503158003596823792560618288887991952647435002576897',
            'owner' => 0,
            'owner_opensea' => '',
        ],
        'acid-projectile' => [
            'nft_id' => 55,
            'img_id' => 84,
            'price' => 0.3,
            'token_id' => '54545543118371850173410875503158003596823792560618288887991952648534514204673',
            'owner' => 0,
            'owner_opensea' => '',
        ],
        'paralyzer' => [
            'nft_id' => 56,
            'img_id' => 85,
            'price' => 0.3,
            'token_id' => '54545543118371850173410875503158003596823792560618288887991952649634025832449',
            'owner' => 0,
            'owner_opensea' => '',
        ],
        'destroy-duration' => [
            'nft_id' => 57,
            'img_id' => 86,
            'price' => 0.3,
            'token_id' => '54545543118371850173410875503158003596823792560618288887991952650733537460225',
            'owner' => 0,
            'owner_opensea' => '',
        ],
        'base-command-link' => [
            'nft_id' => 58,
            'img_id' => 87,
            'price' => 0.15,
            'token_id' => '54545543118371850173410875503158003596823792560618288887991952651833049088001',
            'owner' => 0,
            'owner_opensea' => '',
        ],
        'revive-procedure' => [
            'nft_id' => 59,
            'img_id' => 88,
            'price' => 0.3,
            'token_id' => '54545543118371850173410875503158003596823792560618288887991952652932560715777',
            'owner' => 0,
            'owner_opensea' => '',
        ],
        'time-warp' => [
            'nft_id' => 60,
            'img_id' => 89,
            'price' => 0.5,
            'token_id' => '54545543118371850173410875503158003596823792560618288887991952654032072343553',
            'owner' => 0,
            'owner_opensea' => '',
        ],
        'repair-ship' => [
            'nft_id' => 61,
            'img_id' => 90,
            'price' => 0.15,
            'token_id' => '54545543118371850173410875503158003596823792560618288887991952655131583971329',
            'owner' => 0,
            'owner_opensea' => '',
        ],
        'disturbing-signals' => [
            'nft_id' => 62,
            'img_id' => 91,
            'price' => 0.3,
            'token_id' => '54545543118371850173410875503158003596823792560618288887991952656231095599105',
            'owner' => 0,
            'owner_opensea' => '',
        ],
        'collision-skill' => [
            'nft_id' => 63,
            'img_id' => 92,
            'price' => 0.15,
            'token_id' => '54545543118371850173410875503158003596823792560618288887991952657330607226881',
            'owner' => 0,
            'owner_opensea' => '',
        ],
        'drone-leader' => [
            'nft_id' => 64,
            'img_id' => 93,
            'price' => 0.3,
            'token_id' => '54545543118371850173410875503158003596823792560618288887991952658430118854657',
            'owner' => 0,
            'owner_opensea' => '',
        ],
        'sacrifice' => [
            'nft_id' => 65,
            'img_id' => 94,
            'price' => 0.3,
            'token_id' => '54545543118371850173410875503158003596823792560618288887991952659529630482433',
            'owner' => 0,
            'owner_opensea' => '',
        ],
        'nitro' => [
            'nft_id' => 66,
            'img_id' => 95,
            'price' => 0.15,
            'token_id' => '54545543118371850173410875503158003596823792560618288887991952660629142110209',
            'owner' => 0,
            'owner_opensea' => '',
        ],
        'commander-capt-shera-kinson' => [
            'nft_id' => 67,
            'img_id' => 11,
            'price' => 0.5,
            'token_id' => '',
            'owner' => 0,
            'owner_opensea' => '',
        ],
        'commander-capt-wayne-mccarter' => [
            'nft_id' => 68,
            'img_id' => 12,
            'price' => 0.5,
            'token_id' => '',
            'owner' => 0,
            'owner_opensea' => '',
        ],
        'commander-zyre' => [
            'nft_id' => 69,
            'img_id' => 13,
            'price' => 0.5,
            'token_id' => '',
            'owner' => 0,
            'owner_opensea' => '',
        ],
        'commander-dr-stein' => [
            'nft_id' => 70,
            'img_id' => 5,
            'price' => 0.5,
            'token_id' => '',
            'owner' => 0,
            'owner_opensea' => '',
        ],
        'starship' => [
            'nft_id' => 71,
            'img_id' => 228,
            'price' => 1,
            'token_id' => '',
            'owner' => 0,
            'owner_opensea' => '',
        ],
        'death-ray' => [
            'nft_id' => 72,
            'img_id' => 229,
            'price' => 0.4,
            'token_id' => '',
            'owner' => 0,
            'owner_opensea' => '',
        ],
        'mega-shield' => [
            'nft_id' => 73,
            'img_id' => 204,
            'price' => 0.3,
            'token_id' => '',
            'owner' => 0,
            'owner_opensea' => '',
        ],
        'repair-shield' => [
            'nft_id' => 74,
            'img_id' => 205,
            'price' => 0.3,
            'token_id' => '',
            'owner' => 0,
            'owner_opensea' => '',
        ],
        'energy-source' => [
            'nft_id' => 75,
            'img_id' => 206,
            'price' => 0.3,
            'token_id' => '',
            'owner' => 0,
            'owner_opensea' => '',
        ],
        'secret-deposit' => [
            'nft_id' => 76,
            'img_id' => 207,
            'price' => 0.3,
            'token_id' => '',
            'owner' => 0,
            'owner_opensea' => '',
        ],
        'deja-vu' => [
            'nft_id' => 77,
            'img_id' => 208,
            'price' => 0.3,
            'token_id' => '',
            'owner' => 0,
            'owner_opensea' => '',
        ],
        'fate' => [
            'nft_id' => 78,
            'img_id' => 209,
            'price' => 0.3,
            'token_id' => '',
            'owner' => 0,
            'owner_opensea' => '',
        ],
        'meteor-shower' => [
            'nft_id' => 79,
            'img_id' => 210,
            'price' => 0.3,
            'token_id' => '',
            'owner' => 0,
            'owner_opensea' => '',
        ],
        'great-disturbance' => [
            'nft_id' => 80,
            'img_id' => 211,
            'price' => 0.3,
            'token_id' => '',
            'owner' => 0,
            'owner_opensea' => '',
        ],
        'surprise-attack' => [
            'nft_id' => 81,
            'img_id' => 213,
            'price' => 0.15,
            'token_id' => '',
            'owner' => 0,
            'owner_opensea' => '',
        ],
        'electrocution' => [
            'nft_id' => 82,
            'img_id' => 214,
            'price' => 0.3,
            'token_id' => '',
            'owner' => 0,
            'owner_opensea' => '',
        ],
        'transformation' => [
            'nft_id' => 83,
            'img_id' => 215,
            'price' => 0.3,
            'token_id' => '',
            'owner' => 0,
            'owner_opensea' => '',
        ],
        'moment-of-peace' => [
            'nft_id' => 84,
            'img_id' => 216,
            'price' => 0.3,
            'token_id' => '',
            'owner' => 0,
            'owner_opensea' => '',
        ],
        'cancel' => [
            'nft_id' => 85,
            'img_id' => 217,
            'price' => 0.3,
            'token_id' => '',
            'owner' => 0,
            'owner_opensea' => '',
        ],
        'brilliance' => [
            'nft_id' => 86,
            'img_id' => 218,
            'price' => 0.15,
            'token_id' => '',
            'owner' => 0,
            'owner_opensea' => '',
        ],
        'great-plan' => [
            'nft_id' => 87,
            'img_id' => 219,
            'price' => 0.2,
            'token_id' => '',
            'owner' => 0,
            'owner_opensea' => '',
        ],
        'cluster-nuke' => [
            'nft_id' => 88,
            'img_id' => 220,
            'price' => 0.15,
            'token_id' => '',
            'owner' => 0,
            'owner_opensea' => '',
        ],
        'deploy-starship' => [
            'nft_id' => 89,
            'img_id' => 221,
            'price' => 0.3,
            'token_id' => '',
            'owner' => 0,
            'owner_opensea' => '',
        ],
        'starhunter' => [
            'nft_id' => 90,
            'img_id' => 222,
            'price' => 0.3,
            'token_id' => '',
            'owner' => 0,
            'owner_opensea' => '',
        ],
        'hacker' => [
            'nft_id' => 91,
            'img_id' => 223,
            'price' => 0.3,
            'token_id' => '',
            'owner' => 0,
            'owner_opensea' => '',
        ],
        'indestructible-viper' => [
            'nft_id' => 92,
            'img_id' => 224,
            'price' => 0.2,
            'token_id' => '',
            'owner' => 0,
            'owner_opensea' => '',
        ],
        'resource-ship' => [
            'nft_id' => 93,
            'img_id' => 225,
            'price' => 0.2,
            'token_id' => '',
            'owner' => 0,
            'owner_opensea' => '',
        ],
        'scout' => [
            'nft_id' => 94,
            'img_id' => 226,
            'price' => 0.2,
            'token_id' => '',
            'owner' => 0,
            'owner_opensea' => '',
        ],
        'duplication' => [
            'nft_id' => 95,
            'img_id' => 227,
            'price' => 0.3,
            'token_id' => '',
            'owner' => 0,
            'owner_opensea' => '',
        ],
        'station-repair' => [
            'nft_id' => 96,
            'img_id' => 230,
            'price' => 0.3,
            'token_id' => '',
            'owner' => 0,
            'owner_opensea' => '',
        ],
        'release-of-energy' => [
            'nft_id' => 97,
            'img_id' => 231,
            'price' => 0.3,
            'token_id' => '',
            'owner' => 0,
            'owner_opensea' => '',
        ],
        'time-travel-portal' => [
            'nft_id' => 98,
            'img_id' => 244,
            'price' => 0.4,
            'token_id' => '',
            'owner' => 0,
            'owner_opensea' => '',
        ],
        'satellite' => [
            'nft_id' => 99,
            'img_id' => 248,
            'price' => 0.15,
            'token_id' => '',
            'owner' => 0,
            'owner_opensea' => '',
        ],
        'obstacles' => [
            'nft_id' => 100,
            'img_id' => 281,
            'price' => 0.15,
            'token_id' => '',
            'owner' => 0,
            'owner_opensea' => '',
        ],
        'return' => [
            'nft_id' => 101,
            'img_id' => 282,
            'price' => 0.3,
            'token_id' => '',
            'owner' => 0,
            'owner_opensea' => '',
        ],
        'death-ray-cannon' => [
            'nft_id' => 102,
            'img_id' => 203,
            'price' => 0.3,
            'token_id' => '',
            'owner' => 0,
            'owner_opensea' => '',
        ],
    ];
}

function getNFTOpenSeaOwner( string $token_id, string $contract = '' ) : string
{
    if ( $contract === '' ) {
        // OpenSea Shared Contract
        $contract = '0x495f947276749ce646f68ac8c248420045cb7b5e';
    }
    $json_url = 'https://api.opensea.io/api/v1/asset/'.$contract.'/'.$token_id.'/?format=json';

    // Create a stream
    $opts = [
        'http' => [
            'method' => 'GET',
            'header' => 'X-API-KEY: '.SECRET_OPENSEA_API_KEY,
        ]
    ];
    $context = stream_context_create( $opts );

    $json = @file_get_contents( $json_url, false, $context );

    $json_decode = json_decode( $json );
    return $json_decode->{'top_ownerships'}[0]->{'owner'}->{'user'}->{'username'} ?? '';
}

function verifyNFTCode( string $submitted_code, int $user_id ) : string
{
    if ( substr_count( $submitted_code, ':' ) != 2 ) return 'incorrect_code';

    $parts = explode( ':', $submitted_code );
    $card_slug = $parts[0];
    $nft_id = $parts[1];

    if ( !is_numeric( $nft_id ) ) return 'incorrect_code';
    if ( !ctype_alnum( str_replace( '-', '', $card_slug ) ) ) return 'incorrect_code';

    $nft_first_edition = getNFTFirstEdition();

    if ( !isset( $nft_first_edition[$card_slug] ) ) return 'incorrect_code';
    if ( $nft_first_edition[$card_slug]['nft_id'] != $nft_id ) return 'incorrect_code';
    if ( $nft_first_edition[$card_slug]['token_id'] === '' ) return 'incorrect_code';

    $correct_code = $card_slug.':'.$nft_id.':';
    $correct_code .= sha1( $card_slug.$nft_id.SECRET_SALT_NFT_CODE );

    if ($submitted_code != $correct_code) return 'incorrect_code';

    if ( apcu_exists( 'first_edition_owner:'.$card_slug ) ) {
        $old_owner = (int) apcu_fetch( 'first_edition_owner:'.$card_slug );
    } else {
        $old_owner = $nft_first_edition[$card_slug]['owner'];
    }

    // Already registered as owner, no need to continue
    if ( $old_owner === $user_id ) return 'alread_owner';

    $new_owner_opensea = getNFTOpenSeaOwner( $nft_first_edition[$card_slug]['token_id'] );

    // Error in the OpenSea API?
    if ( $new_owner_opensea === '' ) return 'opensea_api_error';

    if ( apcu_exists( 'first_edition_owner_opensea:'.$card_slug ) ) {
        $old_owner_opensea = apcu_fetch( 'first_edition_owner_opensea:'.$card_slug );
    } else {
        $old_owner_opensea = $nft_first_edition[$card_slug]['owner_opensea'];
    }

    // Old owner did not change in OpenSea
    if ( $new_owner_opensea === $old_owner_opensea ) return 'owner_not_changed';

    // All is ok
    $ttl = 3600*24*30*5;
    apcu_store( 'first_edition_owner:'.$card_slug, $user_id, $ttl );
    apcu_store( 'first_edition_owner_opensea:'.$card_slug, $new_owner_opensea, $ttl );
    return 'all_ok';
}

// Used in the admin
function getUpdateInfoNFTFirstEdition() : void
{
    $nft_first_edition = getNFTFirstEdition();
    foreach ($nft_first_edition as $card_slug => $array) {
        if ( !apcu_exists( 'first_edition_owner:'.$card_slug ) ) continue;
        $owner = apcu_fetch( 'first_edition_owner:'.$card_slug );
        if ( $owner ===  $array['owner'] ) continue;
        echo 'Update getNFTFirstEdition for '.$card_slug.', owner to be: '.$owner.'<br>';
    }
    foreach ($nft_first_edition as $card_slug => $array) {
        if ( !apcu_exists( 'first_edition_owner_opensea:'.$card_slug ) ) continue;
        $owner_opensea = apcu_fetch( 'first_edition_owner_opensea:'.$card_slug );
        if ( $owner_opensea ===  $array['owner_opensea'] ) continue;
        echo 'Update getNFTFirstEdition for '.$card_slug.', owner_opensea to be: '.$owner_opensea.'<br>';
    }
}

// For the commander card pages
function displayCardNFTinfo( string $card_slug ) : string
{
    $nft_first_edition = getNFTFirstEdition();

    if ( !isset($nft_first_edition[$card_slug] ) ) return '';
    if ( $nft_first_edition[$card_slug]['token_id'] === '' ) return '';
    
    if ( apcu_exists( 'first_edition_owner:'.$card_slug ) ) {
        $owner = (int) apcu_fetch( 'first_edition_owner:'.$card_slug );
        $owner_opensea = apcu_fetch( 'first_edition_owner_opensea:'.$card_slug );
    } else {
        $owner = $nft_first_edition[$card_slug]['owner'];
        $owner_opensea = $nft_first_edition[$card_slug]['owner_opensea'];
    }

    $return = '<h2>First Edition of this card as a NFT</h2>';
    if ( $owner == 0 && $owner_opensea === '' ) {
        $return .= '<p>The NFT of this card is not yet bought by anyone, <a href="https://opensea.io/assets/0x495f947276749ce646f68ac8c248420045cb7b5e/'.$nft_first_edition[$card_slug]['token_id'].'" target="_blank">buy it now for '.$nft_first_edition[$card_slug]['price'].' ETH</a> or <a href="/first-edition">buy another card</a>.</p>';
    } elseif ( $owner == 0 ) {
        $return .= '<p>The NFT of this card is currently owned by '.$owner_opensea.'.<br>You can <a href="https://opensea.io/assets/0x495f947276749ce646f68ac8c248420045cb7b5e/'.$nft_first_edition[$card_slug]['token_id'].'" target="_blank">submit an offer to '.$row['username'].'</a> or <a href="/first-edition">buy another card</a>.</p>';
    } else {
        $pdo = PDOWrap::getInstance();
        $row = $pdo->run("SELECT username, country FROM users WHERE id = ? LIMIT 1", [$owner])->fetch();
        $return .= '<p>The NFT of this card is currently owned by <a href="/users/'.$row['username'].'" style="padding-right:20px;font-weight:bold;background:url(https://staticjw.com/redistats/images/flags/'.$row['country'].'.gif) no-repeat center right;">'.$row['username'].'</a>.<br>You can <a href="https://opensea.io/assets/0x495f947276749ce646f68ac8c248420045cb7b5e/'.$nft_first_edition[$card_slug]['token_id'].'" target="_blank">submit an offer to '.$row['username'].'</a> or <a href="/first-edition">buy another card</a>.</p>';
    }

    return $return;
}

function getFirstEditionNFTbyUser( int $user_id ) : array
{
    $return = [];
    $nft_first_edition = getNFTFirstEdition();
    foreach ( $nft_first_edition as $card_slug => $array ) {
        $owner = (int) apcu_fetch( 'first_edition_owner:'.$card_slug );
        if ( $owner === 0 ) {
            $owner = $array['owner'];
        }
        if ( $owner != $user_id ) continue;
        $return[$card_slug] = $card_slug;
    }

    return $return;
}
